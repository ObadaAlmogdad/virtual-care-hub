<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Ø§Ø®ØªØ¨Ø§Ø± Pusher - Laravel</title>
</head>
<body>
  <h2>ğŸ”” Ø§Ø®ØªØ¨Ø§Ø± Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø¹Ø¨Ø± WebSocket</h2>
  <div id="messages"></div>

  <script src="https://js.pusher.com/7.2/pusher.min.js"></script>
  <script>
    // Ù„ØªØ³Ø¬ÙŠÙ„ ÙƒÙ„ Ø£Ø­Ø¯Ø§Ø« Pusher ÙÙŠ Console
    Pusher.logToConsole = true;

    const pusher = new Pusher('4b0bcf74bbde610d48d7', {
      cluster: 'eu',
      authEndpoint: 'http://localhost:8000/broadcasting/auth', // ğŸ” Ù†Ù‚Ø·Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ù…Ù† Laravel
      auth: {
        headers: {
          Authorization: 'Bearer 4|hmbcVnoPMRNC2mRMCRw7Mfz48EqkbkPlJ7H8s89g81a10f0c'
        }
      },
      forceTLS: false // âœ… Ø§Ø¬Ø¹Ù„Ù‡Ø§ false Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ¹Ù…Ù„ Ø¹Ù„Ù‰ http ÙˆÙ„ÙŠØ³ https
    });

    const channel = pusher.subscribe('private-chat.1');
    channel.bind('NewMessageEvent', function (data) {
      console.log('ğŸ“¥ Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©:', data);

      const msgBox = document.getElementById('messages');
      const msg = document.createElement('div');
      msg.innerText = `ğŸ’¬ ${data.message}`;
      msgBox.appendChild(msg);
    });
  </script>
</body>
</html>
